# オセロゲーム 要件定義（サーバーレス環境・DynamoDB 利用）

## 基本機能
- **ブラウザ上で動作するプレイヤー vs CPU の対戦型オセロゲーム:**  
  ウェブブラウザ上で人間プレイヤーとコンピューターが対戦するオセロゲームです。
- **ゲームルールの実装:**
  - **盤面設定:** 8x8 の盤面を初期表示し、中央に4枚の駒（左上が白）を配置します。
  - **プレイヤーの色:** プレイヤーは自分の色を選ぶか、ランダムに決定されます。
  - **ターン順:** 黒が先手、白が後手となります。
  - **ターン進行:** 駒を置くとターンが進行します。
  - **駒の裏返し:** 挟んだ相手の駒が裏返ります。
  - **有効な手:** 置ける場所がある場合にのみ駒を置くことができます。
  - **強制パス:** 置ける場所がない場合は自動的にパスとなります。
  - **ゲーム終了:** 両者ともに置ける場所がなくなった時点でゲーム終了となります。
  - **勝利条件:** 盤面上の駒の枚数が多い方が勝利となります。
  - **結果表示 & リスタート:** 勝敗を表示し、リスタート機能を提供します。

## モード選択
- **トップページ:**  
  ページアクセス時にトップページが表示され、ユーザーはゲームモードを選択します。
- **選択可能なモード:**
  - **オフライン対戦モード:**  
    ローカルのプレイヤー同士で対戦します。
  - **CPU（弱い）:**  
    CPU（弱い難易度）との対戦。
  - **CPU（普通）:**  
    CPU（普通難易度）との対戦。
  - **CPU（強い）:**  
    CPU（強い難易度）との対戦。

## 技術構成

### フロントエンド
- **技術:**  
  Vue.js（Plain JavaScript版）を唯一のフロントエンドフレームワークとして使用します。
- **通信:**  
  フロントエンドは Fetch API を利用してバックエンド API と通信します。
- **ホスティング & ドメイン管理:**  
  フロントエンドは GitHub Pages によるホスティングが可能です。GitHub Pages では無料のサブドメイン（username.github.io）が提供され、ドメイン管理の負担を軽減できます。

### バックエンド（サーバーレス環境）
- **実装言語:**  
  Python（FastAPI または Flask を使用）
- **サーバーレスデプロイ:**
  - **Amazon API Gateway:**  
    フロントエンドからの HTTP リクエストを受け付け、AWS Lambda へルーティングします。
  - **AWS Lambda:**  
    ゲームロジックや AI 推論処理を実行します。  
    リクエストに含まれるパラメータ（例："difficulty"）に基づき、以下のように処理を分岐させます:
    - **弱い:**  
      完全ランダムな手、または簡易な評価関数を用いた推論。
    - **普通:**  
      ミニマックス法など、基本的な盤面評価アルゴリズムによる推論。
    - **強い:**  
      ミニマックス法＋αβ枝刈りなど、より高度なアルゴリズムや AI ライブラリ（TensorFlow、PyTorch、scikit-learn など）を活用した推論。
  - **Amazon DynamoDB:**  
    ゲーム状態の管理に利用します。  
    各対戦には一意のマッチ ID を発行し、盤面情報、ターン情報、スコアなどの対戦状況を DynamoDB に保存します。  
    各ターンごとに Lambda 関数は DynamoDB から最新の状態を取得し、推論後に更新された状態を保存することで、対戦中の状態を保持します。
  - **AWS CloudWatch Logs:**  
    Lambda 関数のログやエラー、パフォーマンス情報の監視に利用します。

- **オプション:**
  - 高度な AI モデルを利用する場合は、Amazon SageMaker のエンドポイントを Lambda から呼び出す設計も検討できます（必要に応じて）。

### 環境構築（Docker 利用）
- **コンテナ化:**  
  Docker を利用して、開発環境および依存パッケージの管理を行います。  
  これにより、ローカル環境に直接パッケージをインストールする必要がなく、すべての依存関係は Docker コンテナ内で管理されます。
- **メリット:**  
  - 環境間の一貫性が確保される。
  - 依存関係の管理が容易になり、ローカルマシンを汚さない。
  - 本番環境へのデプロイもシンプルになる。

## 難易度別 AI 推論
- **リクエストパラメータ:**  
  フロントエンドから送信されるリクエストに「difficulty」パラメータ（例："weak", "normal", "strong"）を含めます。
- **Lambda 内での分岐処理:**  
  上記パラメータにより、以下の処理を選択して実行します:
  - **弱い:** 完全ランダムまたは簡易評価関数を適用。
  - **普通:** 基本的な盤面評価アルゴリズム（ミニマックス法など）を実施。
  - **強い:** αβ枝刈りを取り入れた高度な盤面評価アルゴリズム、または AI ライブラリを活用した推論を実行。

## ゲーム状態の管理（DynamoDB 利用）
- **目的:**  
  AWS Lambda はステートレスなため、各対戦中のゲーム状態（盤面、ターン、スコアなど）を永続的に保持するために DynamoDB を使用します。
- **実装例:**
  - 各対戦開始時に一意のマッチ ID を生成。
  - 盤面の状態や各プレイヤーの情報を、マッチ ID をキーとして DynamoDB のテーブルに保存。
  - 各ターンごとに、Lambda 関数が DynamoDB から最新の状態を取得し、次の一手を計算後、更新情報を DynamoDB に書き戻します。

## デプロイ概要
- **フロントエンド:**  
  GitHub Pages にホスティングし、ドメイン管理の負担を軽減。
- **バックエンド:**  
  AWS のサーバーレスサービス（Amazon API Gateway、AWS Lambda、Amazon DynamoDB、CloudWatch Logs）を組み合わせた環境で運用します。
